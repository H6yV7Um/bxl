<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>自动渲染全景</title>
        <link rel="stylesheet" href="../lib.css">
        <link rel="stylesheet" href="../index.css">
        <style>
            #test {
                width: 100vw;
                height: 30vh;
                overflow: visible;   
            }
            header {
                line-height: 50px;
                font-size: 20px;
                text-align: center;
            }
            section {
                position: relative;
                background: rgb(233, 228, 228);
                transition: 1s transform ease-out;
                z-index: 20;
            }
            section h2 {
                margin: 0;
                font-size: 18px;
                line-height: 50px;
                text-align: center;
            }
            ul {
                list-style: none;
                margin: 0;
                padding: 0;
            }
            li {
                padding-left: 20px;
                line-height: 40px;
                border-bottom: 1px solid #e1e1e1;
                font-size: 14px;
            }
            li:nth-child(2n) {
                background: rgb(219, 215, 215);
            }
            h4 {
                padding-left: 20px;
                font-weight: normal;
                margin: 0;
                line-height: 50px;
            }
            .card header {
                background: #fff;
            }
        </style>
    </head>
    <body>
        <script src="../lib.js"></script>
        <section class="card">
            <header>天气卡片 demo</header>
            <h4>随便放一个卡片</h4>
            <h4>随便放一个卡片</h4>
            <h4>随便放一个卡片</h4>
        </section>
        <div id="test" ref="mytest"></div>
        <section class="content">
                <h2>主体内容区域</h2>
                <ul>
                    <li>用科技让复杂的世界更复杂</li>
                    <li>abcd</li>
                    <li>abcd</li>
                    <li>abcd</li>
                    <li>abcd</li>
                    <li>先帝创业未半而中道崩殂，今天下三分...</li>
                    <li>先帝创业未半而中道崩殂，今天下三分...</li>
                    <li>先帝创业未半而中道崩殂，今天下三分...</li>
                </ul>  
        </section>
    </body>

    <script>
        function find(selector) {
            return document.querySelector(selector);
        }


        const elem = find('#test');
        const s1 = find('.card');
        const s2 = find('.content');
        let canvas;
        let panoram;

        // start
        bxl.start('./card.json', '#test', {
            'scene-init': function(obj) {
                panoram = obj;
                canvas = panoram.getCanvas();
                canvas.style.position = 'relative';
                canvas.style.top = '-200px';
            }
        });

        elem.onclick = function () {
            window.scroll(0, 0);
            const top1 = s1.getBoundingClientRect().bottom;
            const top2 = window.innerHeight - s2.getBoundingClientRect().top;

            s1.style.transform = 'translate3d(0px, -' + top1 + 'px, 0px)';
            s2.style.transform = 'translate3d(0px, ' + top2 + 'px, 0px)';
            panoram.setFov(55);

            setTimeout(function() {
                elem.style.cssText = 'position:fixed;left:0;top:0;right:0;bottom:0;z-index:100;'
                canvas.style.top = 0;
            }, 1000);
        };
    </script>
</html>